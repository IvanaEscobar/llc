clear all;

define_indices;
set_directory;

b=readbin([dirBathy 'bathy_aste1080x1440x540_v1.bin'],[nx ny],1,'real*4');b=abs(b);

[b,bf]=get_aste_tracer(b,nfx,nfy);

%face1
ix=1:nx;iy=1:120;bf{1}(ix,iy)=0;		ix=581:590;iy=1124:1134;bf{1}(ix,iy)=0;
ix=961:1020;iy=1321:1380;bf{1}(ix,iy)=0;        ix=553:558;iy=1006:1009;bf{1}(ix,iy)=0;
ix=678:679;iy=1378:1387;bf{1}(ix,iy)=0;         ix=513:524;iy=982:994;bf{1}(ix,iy)=0;
ix=702:706;iy=1398:1406;bf{1}(ix,iy)=0;         ix=512:515;iy=977:979;bf{1}(ix,iy)=0;
ix=639:640;iy=1337:1341;bf{1}(ix,iy)=0;         ix=510:512;iy=971:973;bf{1}(ix,iy)=0;
ix=753:753;iy=1423:1425;bf{1}(ix,iy)=0;         ix=499:502;iy=959:961;bf{1}(ix,iy)=0;
ix=1020:1021;iy=1439:1440;bf{1}(ix,iy)=0;       ix=440:443;iy=947:948;bf{1}(ix,iy)=0;
ix=622:623;iy=1350:1350;bf{1}(ix,iy)=0;         ix=459:461;iy=991:994;bf{1}(ix,iy)=0;
ix=626:629;iy=1347:1351;bf{1}(ix,iy)=0;         ix=411:415;iy=1032:1034;bf{1}(ix,iy)=0;
ix=598:599;iy=1271:1286;bf{1}(ix,iy)=0;         ix=398:398;iy=1031:1032;bf{1}(ix,iy)=0;

ix=386:386;iy=1080:1081;bf{1}(ix,iy)=0;		ix=101:103;iy=1408:1410;bf{1}(ix,iy)=0;
ix=387:388;iy=1029:1030;bf{1}(ix,iy)=0;         ix=817:819;iy=1397:1402;bf{1}(ix,iy)=0;
ix=338:339;iy=1011:1011;bf{1}(ix,iy)=0;         ix=791:795;iy=1408:1410;bf{1}(ix,iy)=0;
ix=256:258;iy=356:359;bf{1}(ix,iy)=0;           ix=763:770;iy=1412;bf{1}(ix,iy)=0;
ix=263:271;iy=324:336;bf{1}(ix,iy)=0;           ix=750:754;iy=1426:1433;bf{1}(ix,iy)=0;
ix=2:3;iy=1366;bf{1}(ix,iy)=0;                  ix=724:729;iy=1410:1425;bf{1}(ix,iy)=0;
ix=109:113;iy=1429:1440;bf{1}(ix,iy)=0;         ix=716:720;iy=1427:1432;bf{1}(ix,iy)=0;
ix=139:140;iy=1412:1416;bf{1}(ix,iy)=0;         ix=710:713;iy=1414:1426;bf{1}(ix,iy)=0;
ix=204:205;iy=1420:1421;bf{1}(ix,iy)=0;         ix=700:706;iy=1410:1419;bf{1}(ix,iy)=0;
ix=377:379;iy=1194:1198;bf{1}(ix,iy)=0;         ix=683:688;iy=1389:1397;bf{1}(ix,iy)=0;

ix=672:680;iy=1383:1398;bf{1}(ix,iy)=0;		ix=521:522;iy=1124:1125;bf{1}(ix,iy)=0;
ix=666:669;iy=1393:1398;bf{1}(ix,iy)=0;         ix=589:591;iy=1113:1125;bf{1}(ix,iy)=0;
ix=642:650;iy=1345:1363;bf{1}(ix,iy)=0;         ix=591:599;iy=1081:1083;bf{1}(ix,iy)=0;
ix=622:625;iy=1346;bf{1}(ix,iy)=0;              ix=599;iy=1084:1094;bf{1}(ix,iy)=0;
ix=624:630;iy=1321:1326;bf{1}(ix,iy)=0;         ix=596;iy=1096:1101;bf{1}(ix,iy)=0;
ix=620:623;iy=1313:1317;bf{1}(ix,iy)=0;         ix=593;iy=1105:1111;bf{1}(ix,iy)=0;
ix=615:617;iy=1307:1311;bf{1}(ix,iy)=0;         ix=591;iy=1111:1118;bf{1}(ix,iy)=0;
ix=525:527;iy=1198:1199;bf{1}(ix,iy)=0;         ix=355:357;iy=1025:1027;bf{1}(ix,iy)=0;
ix=513:517;iy=1163:1184;bf{1}(ix,iy)=0;         ix=336:337;iy=1008:1019;bf{1}(ix,iy)=0;
ix=517:518;iy=1129;bf{1}(ix,iy)=0;              ix=335:336;iy=1015:1019;bf{1}(ix,iy)=0;

ix=337:348;iy=997:999;bf{1}(ix,iy)=0;		ix=366:368;iy=815:818;bf{1}(ix,iy)=0;
ix=341:345;iy=995:996;bf{1}(ix,iy)=0;           ix=369:377;iy=815;bf{1}(ix,iy)=0;
ix=343;iy=993:995;bf{1}(ix,iy)=0;               ix=252:256;iy=445:457;bf{1}(ix,iy)=0;
ix=401:404;iy=894:899;bf{1}(ix,iy)=0;           ix=1:13;iy=1338:1364;bf{1}(ix,iy)=0;
ix=407:409;iy=888:889;bf{1}(ix,iy)=0;           ix=23:25;iy=1342:1347;bf{1}(ix,iy)=0;
ix=419:423;iy=881:884;bf{1}(ix,iy)=0;           ix=196:212;iy=1284:1302;bf{1}(ix,iy)=0;
ix=439:442;iy=855:863;bf{1}(ix,iy)=0;           ix=189:192;iy=1307:1311;bf{1}(ix,iy)=0;
ix=416:420;iy=807:809;bf{1}(ix,iy)=0;           ix=205:208;iy=1313:1322;bf{1}(ix,iy)=0;
ix=392:394;iy=810:812;bf{1}(ix,iy)=0;           ix=253:256;iy=1302:1306;bf{1}(ix,iy)=0;
ix=368:378;iy=812:814;bf{1}(ix,iy)=0;           ix=239:240;iy=1301:1304;bf{1}(ix,iy)=0;
ix=295;iy=1263:1265;bf{1}(ix,iy)=0;

ix=[ 597, 599, 590, 592, 598, 605, 607, 613, 617, 629, 630, 631, 630, 643, 656,...
     686, 691, 700, 707, 708, 714, 725, 800, 538, 537, 519, 519, 382, 357, 346,...
     258, 111, 654, 577, 350, 227, 256, 671, 763];
iy=[1097,1092,1234,1252,1262,1291,1291,1304,1309,1315,1327,1333,1356,1353,1376,...
    1391,1394,1407,1413,1412,1424,1407,1407,1003,1004, 998, 999,1068,1027, 998,...
     356,1421,1378,1123, 794,1296,1299,1387,1413];
for i=1:length(ix);  bf{1}(ix(i),iy(i))=0; end;

ix=580:588;iy=1123;bf{1}(ix,iy)=(bf{1}(ix,iy-1)+bf{1}(ix,iy+1))./2;
ix=907:1007;iy=1381;bf{1}(ix,iy)=(bf{1}(ix,iy-1)+bf{1}(ix,iy+1))./2;

%now create new blank tile:
ix=540:600;iy=1002:1130;bf{1}(ix,iy)=0;
ix=539;iy=1005:1105;bf{1}(ix,iy)=(bf{1}(ix-1,iy)+bf{1}(ix+1,iy))./2;

ix=360:432;iy=240:250;bf{1}(ix,iy)=0;
ix=360:432;iy=239;bf{1}(ix,iy)=(bf{1}(ix,iy-1)+bf{1}(ix,iy+1))./2;
ix=630:639;iy=1336:1344;bf{1}(ix,iy)=0;
ix=629;iy=1336:1344;bf{1}(ix,iy)=(bf{1}(ix-1,iy)+bf{1}(ix+1,iy))./2;

ix=585:593;iy=1245:1260;bf{1}(ix,iy)=0;

%Spain:
ix=396:437;iy=807:810;bf{1}(ix,iy)=0;
ix=396:437;iy=811;bf{1}(ix,iy)=(bf{1}(ix,iy-1)+bf{1}(ix,iy+1))./2;

%UK
ix=495:499;iy=958:961;bf{1}(ix,iy)=0;

%Iceland
ix=215:300;iy=1285:1308;bf{1}(ix,iy)=0;
ix=301;iy=1285:1308;bf{1}(ix,iy)=(bf{1}(ix-1,iy)+bf{1}(ix+1,iy))./2;
ix=215:301;iy=1309;bf{1}(ix,iy)=(bf{1}(ix,iy-1)+bf{1}(ix,iy+1))./2;

%face3:
ix=44:46;iy=879;bf{3}(ix,iy)=0;		ix=161:177;iy=740:754;bf{3}(ix,iy)=0;
ix=59:79;iy=863:873;bf{3}(ix,iy)=0;     ix=187:188;iy=724;bf{3}(ix,iy)=0;
ix=71:73;iy=833:836;bf{3}(ix,iy)=0;     ix=188:191;iy=720:721;bf{3}(ix,iy)=0;
ix=82:84;iy=808:818;bf{3}(ix,iy)=0;     ix=196:227;iy=713:734;bf{3}(ix,iy)=0;
ix=85:92;iy=838:843;bf{3}(ix,iy)=0;     ix=171:174;iy=730:739;bf{3}(ix,iy)=0;
ix=97:111;iy=831:845;bf{3}(ix,iy)=0;    ix=199:227;iy=709:712;bf{3}(ix,iy)=0;
ix=103:109;iy=767:769;bf{3}(ix,iy)=0;   ix=211:227;iy=704:708;bf{3}(ix,iy)=0;
ix=115:116;iy=764:767;bf{3}(ix,iy)=0;   ix=212:224;iy=701:703;bf{3}(ix,iy)=0;
ix=120:123;iy=762:764;bf{3}(ix,iy)=0;   ix=216:218;iy=699:700;bf{3}(ix,iy)=0;
ix=134:147;iy=759:764;bf{3}(ix,iy)=0;   ix=250:259;iy=682:695;bf{3}(ix,iy)=0;

ix=295:297;iy=660:662;bf{3}(ix,iy)=0;	ix=499:507;iy=874:885;bf{3}(ix,iy)=0;
ix=359:369;iy=667:688;bf{3}(ix,iy)=0;   ix=572:574;iy=886:891;bf{3}(ix,iy)=0;
ix=380:394;iy=699:739;bf{3}(ix,iy)=0;   ix=513:538;iy=916:944;bf{3}(ix,iy)=0;
ix=395:400;iy=724:728;bf{3}(ix,iy)=0;   ix=554:555;iy=957:960;bf{3}(ix,iy)=0;
ix=402:403;iy=746:747;bf{3}(ix,iy)=0;   ix=575:577;iy=897:904;bf{3}(ix,iy)=0;
ix=406:407;iy=765:765;bf{3}(ix,iy)=0;   ix=607:612;iy=859:862;bf{3}(ix,iy)=0;
ix=412:419;iy=761:777;bf{3}(ix,iy)=0;   ix=609:609;iy=837:838;bf{3}(ix,iy)=0;
ix=467:474;iy=801:813;bf{3}(ix,iy)=0;   ix=588:589;iy=979:983;bf{3}(ix,iy)=0;
ix=474:476;iy=846:847;bf{3}(ix,iy)=0;   ix=596:600;iy=964:969;bf{3}(ix,iy)=0;
ix=485:492;iy=856:859;bf{3}(ix,iy)=0;   ix=605:606;iy=1000:1001;bf{3}(ix,iy)=0;

ix=426:431;iy=912:914;bf{3}(ix,iy)=0;	ix=220:221;iy=1080:1080;bf{3}(ix,iy)=0;
ix=376:378;iy=941:944;bf{3}(ix,iy)=0;   ix=206:210;iy=1079:1080;bf{3}(ix,iy)=0;
ix=410:411;iy=949:949;bf{3}(ix,iy)=0;   ix=299:300;iy=1007:1013;bf{3}(ix,iy)=0;
ix=324:332;iy=967:971;bf{3}(ix,iy)=0;   ix=302:304;iy=1005:1008;bf{3}(ix,iy)=0;
ix=313:318;iy=983:988;bf{3}(ix,iy)=0;   ix=312:314;iy=993:996;bf{3}(ix,iy)=0;
ix=303:310;iy=992:1001;bf{3}(ix,iy)=0;  ix=333:338;iy=965:970;bf{3}(ix,iy)=0;
ix=286:298;iy=1003:1016;bf{3}(ix,iy)=0; ix=335:335;iy=971:972;bf{3}(ix,iy)=0;
ix=249:250;iy=1045;bf{3}(ix,iy)=0;      ix=436:437;iy=927:927;bf{3}(ix,iy)=0;
ix=244:258;iy=1031:1036;bf{3}(ix,iy)=0; ix=291:297;iy=653:660;bf{3}(ix,iy)=0;
ix=237:247;iy=1037:1047;bf{3}(ix,iy)=0; ix=43:43;iy=826:827;bf{3}(ix,iy)=0;

ix=31:36;iy=824:825;bf{3}(ix,iy)=0;
ix=11:16;iy=833:835;bf{3}(ix,iy)=0;
ix=37:37;iy=878:880;bf{3}(ix,iy)=0;

ix=497:510;iy=1071:1080;bf{3}(ix,iy)=0;
ix=516:519;iy=1078:1080;bf{3}(ix,iy)=0;
ix=554:554;iy=908:909;bf{3}(ix,iy)=0;
ix=541:542;iy=893:893;bf{3}(ix,iy)=0;
ix=527:555;iy=788:797;bf{3}(ix,iy)=0;
ix=532:532;iy=777:777;bf{3}(ix,iy)=0;
ix=549:550;iy=796:796;bf{3}(ix,iy)=0;
ix=569:571;iy=810:812;bf{3}(ix,iy)=0;
ix=574:577;iy=806:808;bf{3}(ix,iy)=0;

ix=647:649;iy=1075:1080;bf{3}(ix,iy)=0;
ix=646:647;iy=1023:1027;bf{3}(ix,iy)=0;
ix=640:643;iy=1054:1055;bf{3}(ix,iy)=0;

ix=667:676;iy=1028:1053;bf{3}(ix,iy)=0;
ix=675:686;iy=1079:1080;bf{3}(ix,iy)=0;
ix=671:683;iy=1015:1020;bf{3}(ix,iy)=0;
ix=699:709;iy=1038:1045;bf{3}(ix,iy)=0;
ix=767:780;iy=1020:1057;bf{3}(ix,iy)=0;
ix=767:780;iy=1019;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;
ix=817:822;iy=1004:1009;bf{3}(ix,iy)=0;
ix=851:855;iy=1029:1032;bf{3}(ix,iy)=0;
ix=872:875;iy=1016:1019;bf{3}(ix,iy)=0;
ix=871:878;iy=1052:1055;bf{3}(ix,iy)=0;
ix=1015:1020;iy=979:985;bf{3}(ix,iy)=0;
ix=1048:1051;iy=953:957;bf{3}(ix,iy)=0;
ix=1056:1062;iy=932:938;bf{3}(ix,iy)=0;
ix=1069:1075;iy=926:930;bf{3}(ix,iy)=0;
ix=747:748;iy=962;bf{3}(ix,iy)=0;
ix=761:780;iy=944:954;bf{3}(ix,iy)=0;
ix=669:679;iy=938:971;bf{3}(ix,iy)=0;
ix=685:686;iy=965;bf{3}(ix,iy)=0;
ix=656:663;iy=940:946;bf{3}(ix,iy)=0;
ix=662:666;iy=938:939;bf{3}(ix,iy)=0;
ix=694:698;iy=940:953;bf{3}(ix,iy)=0;

ix=790:795;iy=922:925;bf{3}(ix,iy)=0;
ix=786:791;iy=913:918;bf{3}(ix,iy)=0;
ix=599:603;iy=143:148;bf{3}(ix,iy)=0;

%Siberian
ix=956:980;iy=152:167;bf{3}(ix,iy)=0;
ix=238:247;iy=2:19;bf{3}(ix,iy)=0;
ix=298:315;iy=63:69;bf{3}(ix,iy)=0;
ix=353:363;iy=16:25;bf{3}(ix,iy)=0;
ix=44:49;iy=32:38;bf{3}(ix,iy)=0;
ix=65:90;iy=12:28;bf{3}(ix,iy)=0;

ix=459:465;iy=84:88;bf{3}(ix,iy)=0;
ix=448:460;iy=78:85;bf{3}(ix,iy)=0;
ix=442:453;iy=60:77;bf{3}(ix,iy)=0;

ix=91;iy=16:18;bf{3}(ix,iy)=0;
ix=35:40;iy=78:81;bf{3}(ix,iy)=0;
ix=157;iy=480:483;bf{3}(ix,iy)=0;
ix=161:166;iy=476:488;bf{3}(ix,iy)=0;
ix=181;iy=477:478;bf{3}(ix,iy)=0;
ix=187:189;iy=479:480;bf{3}(ix,iy)=0;
ix=190:193;iy=488;bf{3}(ix,iy)=0;
ix=197:220;iy=482:508;bf{3}(ix,iy)=0;
ix=206:212;iy=461:470;bf{3}(ix,iy)=0;
ix=214:219;iy=476:477;bf{3}(ix,iy)=0;
ix=221:227;iy=457:466;bf{3}(ix,iy)=0;
ix=237:239;iy=475:479;bf{3}(ix,iy)=0;
ix=240:243;iy=472:474;bf{3}(ix,iy)=0;
ix=237:238;iy=456:457;bf{3}(ix,iy)=0;
ix=242:248;iy=449:453;bf{3}(ix,iy)=0;
ix=525:542;iy=222:232;bf{3}(ix,iy)=0;
ix=548;iy=220:221;bf{3}(ix,iy)=0;
ix=508:514;iy=216:221;bf{3}(ix,iy)=0;
ix=521:529;iy=113:115;bf{3}(ix,iy)=0;
ix=238:247;iy=457:471;bf{3}(ix,iy)=0;
ix=241;iy=475:478;bf{3}(ix,iy)=0;
ix=41:42;iy=819:823;bf{3}(ix,iy)=0;
ix=79:81;iy=805:808;bf{3}(ix,iy)=0;
ix=99:109;iy=777:790;bf{3}(ix,iy)=0;
ix=254:258;iy=673:682;bf{3}(ix,iy)=0;
ix=288:289;iy=685:690;bf{3}(ix,iy)=0;
ix=539:546;iy=917:933;bf{3}(ix,iy)=0;
ix=218:220;iy=145:154;bf{3}(ix,iy)=0;
ix=233;iy=153:155;bf{3}(ix,iy)=0;
ix=239:240;iy=153:155;bf{3}(ix,iy)=0;

ix=[ 22, 35, 37, 55, 90, 92,107,127,129,256,259,272,287,312,472,516,537,540,...
    550,551,585,596,604,442,455,456,400,359,319, 519, 558,539,527,540,532,529,...
    503, 643, 789,825,781,608,573,925,353,565, 36,  9, 10, 74,115,191,192,189];
iy=[899,901,881,859,813,815,757,769,771,682,679,675,689,692,839,817,834,894,...
    818,825,899,877,845,915,913,914,945,946,986,1067,1056,835,796,791,778,771,...
    765,1054,1026,880,937,870,818,104,312,190,882,835,835,810,763,139,140,156];
for i=1:length(ix);bf{3}(ix(i),iy(i))=0;end;

ix=99;iy=816;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;
ix=37;iy=866;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;

%make blank tiles:
ix=180:188;iy=720:725;bf{3}(ix,iy)=0;
ix=181:188;iy=719;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;

ix=507:588;iy=819:901;bf{3}(ix,iy)=0;	ix=596:601;iy=868:901;bf{3}(ix,iy)=0;

ix=536:549;iy=780:789;bf{3}(ix,iy)=0;
ix=536:579;iy=779;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;

ix=787:802;iy=1019:1028;bf{3}(ix,iy)=0;
ix=787:802;iy=1018;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;
ix=830:840;iy=1066:1080;bf{3}(ix,iy)=0;
ix=841;iy=1066:1080;bf{3}(ix,iy)=(bf{3}(ix-1,iy)+bf{3}(ix+1,iy))./2;

ix=960:994;iy=1020:1051;bf{3}(ix,iy)=0;
ix=960:994;iy=1019; bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;
ix=959;iy=1020:1051;bf{3}(ix,iy)=(bf{3}(ix-1,iy)+bf{3}(ix+1,iy))./2;
ix=1017:1040;iy=960:967;bf{3}(ix,iy)=0;
ix=1017:1040;iy=959;bf{3}(ix,iy)=(bf{3}(ix-1,iy)+bf{3}(ix+1,iy))./2;
ix=990;iy=1014:1020;bf{3}(ix,iy)=0;
ix=989;iy=1014:1020;bf{3}(ix,iy)=(bf{3}(ix-1,iy)+bf{3}(ix+1,iy))./2;
ix=990:1007;iy=990:992;bf{3}(ix,iy)=0;
ix=990:1007;iy=989;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;

ix=900:917;iy=77:90;bf{3}(ix,iy)=0;
ix=900:917;iy=91;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;
ix=899;iy=77:91;bf{3}(ix,iy)=(bf{3}(ix-1,iy)+bf{3}(ix+1,iy))./2;
ix=960:966;iy=177:180;bf{3}(ix,iy)=0;
ix=842:881;iy=33:60;bf{3}(ix,iy)=0;
ix=842:881;iy=61;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;
ix=733:761;iy=59:61;bf{3}(ix,iy)=0;
ix=657:697;iy=49:61;bf{3}(ix,iy)=0;
ix=622:661;iy=31:84;bf{3}(ix,iy)=0;
ix=662;iy=65:85;bf{3}(ix,iy)=(bf{3}(ix-1,iy)+bf{3}(ix+1,iy))./2;

ix=531:555;iy=105:118;bf{3}(ix,iy)=0;
ix=540:555;iy=119:120;bf{3}(ix,iy)=0;
ix=298:470;iy=1:60;bf{3}(ix,iy)=0;
ix=300:470;iy=61;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;
ix=313:316;iy=61:62;bf{3}(ix,iy)=0;
ix=348:349;iy=60:63;bf{3}(ix,iy)=0;
ix=450:468;iy=85:90;bf{3}(ix,iy)=0;
ix=450:457;iy=91;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;;
ix=449;iy=85:91;bf{3}(ix,iy)=(bf{3}(ix-1,iy)+bf{3}(ix+1,iy))./2;;

ix=495:499;iy=869:900;bf{3}(ix,iy)=0;
ix=494;iy=869:900;bf{3}(ix,iy)=(bf{3}(ix-1,iy)+bf{3}(ix+1,iy))./2;;

ix=838:855;iy=1052:1080;bf{3}(ix,iy)=0;
ix=856;iy=1052:1080;bf{3}(ix,iy)=(bf{3}(ix-1,iy)+bf{3}(ix+1,iy))./2;;

ix=540:585;iy=900:960;bf{3}(ix,iy)=0;
ix=586;iy=900:960;bf{3}(ix,iy)=(bf{3}(ix-1,iy)+bf{3}(ix+1,iy))./2;;

%Greenland
ix=296:300;iy=1015:1020;bf{3}(ix,iy)=0;
ix=296:300;iy=1021;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;
ix=301;iy=1015:1021;bf{3}(ix,iy)=(bf{3}(ix-1,iy)+bf{3}(ix+1,iy))./2;
ix=364:396;iy=941:945;bf{3}(ix,iy)=0;
ix=364:396;iy=946;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;;

%CAA (see also face5)
ix=1080-630+1:1080;iy=1080;bf{3}(ix,iy)=0;
ix=1080-630+1:1080;iy=1079;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;

%agressive:
ix=850:990;iy=1020:1080;bf{3}(ix,iy)=0;
ix=850:990;iy=1019;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;
ix=697:754;iy=1020:1080;bf{3}(ix,iy)=0;
ix=697:754;iy=1019;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;
ix=630:675;iy=1020:1080;bf{3}(ix,iy)=0;
ix=630:675;iy=1019;bf{3}(ix,iy)=(bf{3}(ix,iy-1)+bf{3}(ix,iy+1))./2;
ix=629;iy=1020:1080;bf{3}(ix,iy)=(bf{3}(ix-1,iy)+bf{3}(ix+1,iy))./2;

%Barents Sea
ix=50:60;iy=43:45;bf{3}(ix,iy)=0;

%face4
ix=10:11;iy=919:928;bf{4}(ix,iy)=0;
ix=154;iy=619:620;bf{4}(ix,iy)=0;
ix=175:179;iy=610:615;bf{4}(ix,iy)=0;
ix=259:281;iy=790:812;bf{4}(ix,iy)=0;
ix=311:332;iy=977:986;bf{4}(ix,iy)=0;
ix=309:364;iy=989:1020;bf{4}(ix,iy)=0;
ix=373:377;iy=1023:1028;bf{4}(ix,iy)=0;
ix=394:400;iy=1042:1048;bf{4}(ix,iy)=0;
ix=422:424;iy=1048:1053;bf{4}(ix,iy)=0;
ix=345:351;iy=989:997;bf{4}(ix,iy)=0;
ix=327:331;iy=980:983;bf{4}(ix,iy)=0;
ix=346:349;iy=769:772;bf{4}(ix,iy)=0;
ix=363:365;iy=767:769;bf{4}(ix,iy)=0;

ix=168:172;iy=545:549;bf{4}(ix,iy)=0;
ix=136:146;iy=520:529;bf{4}(ix,iy)=0;
ix=152:159;iy=475:480;bf{4}(ix,iy)=0;
ix=184:201;iy=418:442;bf{4}(ix,iy)=0;
ix=225:271;iy=251:283;bf{4}(ix,iy)=0;

ix=[267,278,275,339,340,384,404,405,448];
iy=[833,835,862,776,777,711,659,660,199];
for i=1:length(ix);bf{4}(ix(i),iy(i))=0;end;

%make tile
ix=129:154;iy=659:680;bf{4}(ix,iy)=0;
ix=129:154;iy=658;bf{4}(ix,iy)=(bf{4}(ix,iy-1)+bf{4}(ix,iy+1))./2;
ix=386:405;iy=237:240;bf{4}(ix,iy)=0;
ix=386:405;iy=241;bf{4}(ix,iy)=(bf{4}(ix,iy-1)+bf{4}(ix,iy+1))./2;
ix=412:420;iy=220:240;bf{4}(ix,iy)=0;
ix=412:420;iy=241;bf{4}(ix,iy)=(bf{4}(ix,iy-1)+bf{4}(ix,iy+1))./2;
ix=421;iy=220:241;bf{4}(ix,iy)=(bf{4}(ix-1,iy)+bf{4}(ix+1,iy))./2;
ix=51:76;iy=346:372;bf{4}(ix,iy)=0;
ix=50;iy=346:372;bf{4}(ix,iy)=(bf{4}(ix-1,iy)+bf{4}(ix+1,iy))./2;
ix=1:32;iy=259:270;bf{4}(ix,iy)=0;
ix=1:32;iy=271;bf{4}(ix,iy)=(bf{4}(ix,iy-1)+bf{4}(ix,iy+1))./2;
ix=183:205;iy=675:682;bf{4}(ix,iy)=0;
ix=183:205;iy=674;bf{4}(ix,iy)=(bf{4}(ix,iy-1)+bf{4}(ix,iy+1))./2;
ix=188:224;iy=441:450;bf{4}(ix,iy)=0;
ix=188:224;iy=451;bf{4}(ix,iy)=(bf{4}(ix,iy-1)+bf{4}(ix,iy+1))./2;
ix=240;iy=421:435;bf{4}(ix,iy)=0;
ix=241;iy=421:435;bf{4}(ix,iy)=(bf{4}(ix-1,iy)+bf{4}(ix+1,iy))./2;

ix=360:405;iy=1020:1080;bf{4}(ix,iy)=0;
ix=406;iy=1020:1080;bf{4}(ix,iy)=(bf{4}(ix-1,iy)+bf{4}(ix+1,iy))./2;

%aggressive:
ix=261:300;iy=764:946;bf{4}(ix,iy)=0;
ix=301;iy=764:946;bf{4}(ix,iy)=(bf{4}(ix-1,iy)+bf{4}(ix+1,iy))./2;

ix=300:315;iy=770:798;bf{4}(ix,iy)=0;
ix=316;iy=770:798;bf{4}(ix,iy)=(bf{4}(ix-1,iy)+bf{4}(ix+1,iy))./2;

%Siberia
ix=45:52;iy=317:373;bf{4}(ix,iy)=0;
ix=44;iy=317:373;bf{4}(ix,iy)=(bf{4}(ix-1,iy)+bf{4}(ix+1,iy))./2;

%face5

ix=[1295,855,855,858,873,816,345,120,116, 98, 66,131, 128,  96,  9];
iy=[1003,432,442,398,380,568,795,764,749,722,694,880,1052,1078,637];
for i=1:length(ix);bf{5}(ix(i),iy(i))=0;end;

%North America
ix=7:16;iy=619:629;bf{5}(ix,iy)=0;
ix=14:28;iy=633:652;bf{5}(ix,iy)=0;
ix=27:39;iy=647:655;bf{5}(ix,iy)=0;
ix=47:61;iy=674:684;bf{5}(ix,iy)=0;
ix=84;iy=697:699;bf{5}(ix,iy)=0;
ix=135:140;iy=772:774;bf{5}(ix,iy)=0;
ix=147:149;iy=774:775;bf{5}(ix,iy)=0;
ix=152:156;iy=771:773;bf{5}(ix,iy)=0;
ix=154:157;iy=763:767;bf{5}(ix,iy)=0;
ix=147:152;iy=737:745;bf{5}(ix,iy)=0;
ix=166:171;iy=722:724;bf{5}(ix,iy)=0;
ix=195:198;iy=752:755;bf{5}(ix,iy)=0;
ix=189:195;iy=746:751;bf{5}(ix,iy)=0;
ix=420:421;iy=841;bf{5}(ix,iy)=0;
ix=547:557;iy=885:896;bf{5}(ix,iy)=0;
ix=681:684;iy=648:635;bf{5}(ix,iy)=0;
ix=698:711;iy=629:635;bf{5}(ix,iy)=0;
ix=740:743;iy=618:624;bf{5}(ix,iy)=0;
ix=701:739;iy=611:626;bf{5}(ix,iy)=0;
ix=772:773;iy=616:622;bf{5}(ix,iy)=0;
ix=763:769;iy=627:629;bf{5}(ix,iy)=0;
ix=755:771;iy=616:626;bf{5}(ix,iy)=0;
ix=884;iy=369:370;bf{5}(ix,iy)=0;
ix=844;iy=499:501;bf{5}(ix,iy)=0;
ix=915:917;iy=603;bf{5}(ix,iy)=0;
ix=884:887;iy=544:547;bf{5}(ix,iy)=0;
ix=895:899;iy=565:570;bf{5}(ix,iy)=0;
ix=957:961;iy=545:557;bf{5}(ix,iy)=0;
ix=1380:1440;iy=600:1080;bf{5}(ix,iy)=0;
ix=681:685;iy=646:648;bf{5}(ix,iy)=0;

%Greenland:
ix=57:78;iy=860:900;bf{5}(ix,iy)=0;
ix=91:109;iy=872:900;bf{5}(ix,iy)=0;
ix=136:143;iy=885:900;bf{5}(ix,iy)=0;
ix=144;iy=888:889;bf{5}(ix,iy)=0;
ix=153:155;iy=895;bf{5}(ix,iy)=0;
ix=158:179;iy=904:923;bf{5}(ix,iy)=0;
ix=155:162;iy=1032:1042;bf{5}(ix,iy)=0;
ix=128:136;iy=1037:1046;bf{5}(ix,iy)=0;
ix=107:123;iy=1053:1058;bf{5}(ix,iy)=0;
ix=109:110;iy=1060:1065;bf{5}(ix,iy)=0;
ix=175:181;iy=900:905;bf{5}(ix,iy)=0;
ix=85;iy=708:710;bf{5}(ix,iy)=0;
ix=79:83;iy=691:700;bf{5}(ix,iy)=0;
ix=77:78;iy=700:704;bf{5}(ix,iy)=0;
ix=75;iy=699:701;bf{5}(ix,iy)=0;
ix=52:60;iy=690:702;bf{5}(ix,iy)=0;
ix=42:49;iy=684:689;bf{5}(ix,iy)=0;
ix=35:45;iy=675:690;bf{5}(ix,iy)=0;
ix=16:26;iy=652:659;bf{5}(ix,iy)=0;

%make tile
%CAA has no communication to Atlantic: aggressive removal:
ix=1:133;iy=1:630;bf{5}(ix,iy)=0;
ix=2:14;iy=631;bf{5}(ix,iy)=0;
ix=3:14;iy=632;bf{5}(ix,iy)=0;
ix=4:14;iy=633:634;bf{5}(ix,iy)=0;
ix=5:14;iy=635:637;bf{5}(ix,iy)=0;

ix=315:318;iy=778:780;bf{5}(ix,iy)=0;
ix=315:318;iy=781;bf{5}(ix,iy)=(bf{5}(ix,iy-1)+bf{5}(ix,iy+1))./2;
ix=314;iy=778:781;bf{5}(ix,iy)=(bf{5}(ix-1,iy)+bf{5}(ix+1,iy))./2;
ix=405:407;iy=833:840;bf{5}(ix,iy)=0;
ix=405:407;iy=841;bf{5}(ix,iy)=(bf{5}(ix,iy-1)+bf{5}(ix,iy+1))./2;
ix=404;iy=833:841;bf{5}(ix,iy)=(bf{5}(ix-1,iy)+bf{5}(ix+1,iy))./2;

%HudsonBay:
ix=44:489;iy=387:665;bf{5}(ix,iy)=0;
ix=202:260;iy=666;bf{5}(ix,iy)=(bf{5}(ix,iy-1)+bf{5}(ix,iy+1))./2;
ix=240:273;iy=664:675;bf{5}(ix,iy)=0;
ix=240:273;iy=676;bf{5}(ix,iy)=(bf{5}(ix,iy-1)+bf{5}(ix,iy+1))./2;

ix=120:180;iy=700:721;bf{5}(ix,iy)=0;
ix=190:240;iy=660:721;bf{5}(ix,iy)=0;
ix=241;iy=660:721;bf{5}(ix,iy)=(bf{5}(ix-1,iy)+bf{5}(ix+1,iy))./2;;
ix=90:180;iy=722; bf{5}(ix,iy)=(bf{5}(ix,iy-1)+bf{5}(ix,iy+1))./2;;
ix=89:91; iy=715:721;bf{5}(ix,iy)=0;
ix=88;iy=714;bf{5}(ix,iy)=0;

ix=420:480;iy=780:840;bf{5}(ix,iy)=0;	ix=508:513;iy=855:860;bf{5}(ix,iy)=0;
ix=417:480;iy=840:855;bf{5}(ix,iy)=0;
ix=417:480;iy=856;bf{5}(ix,iy)=(bf{5}(ix,iy-1)+bf{5}(ix,iy+1))./2;

%agressive: close HudsonBay:
ix=241:327;iy=675:738;bf{5}(ix,iy)=0;
ix=241:327;iy=739;bf{5}(ix,iy)=(bf{5}(ix,iy-1)+bf{5}(ix,iy+1))./2;
ix=293:319;iy=739:755;bf{5}(ix,iy)=0;
ix=292;iy=739:755;bf{5}(ix,iy)=(bf{5}(ix-1,iy)+bf{5}(ix+1,iy))./2;
%ix=256:320;iy=739:757;bf{5}(ix,iy)=0;

%White Sea
ix=480:548;iy=660:856;bf{5}(ix,iy)=0;
ix=549:553;iy=747:761;bf{5}(ix,iy)=0;
ix=549;iy=762:826;bf{5}(ix,iy)=(bf{5}(ix-1,iy)+bf{5}(ix+1,iy))./2;
ix=540:600;iy=720:780;bf{5}(ix,iy)=0;
ix=540:600;iy=781;bf{5}(ix,iy)=(bf{5}(ix,iy-1)+bf{5}(ix,iy+1))./2;
ix=601;iy=738:762;bf{5}(ix,iy)=(bf{5}(ix-1,iy)+bf{5}(ix+1,iy))./2;
ix=671:676;iy=651:661;bf{5}(ix,iy)=0;

%Gulf of Mexico
ix=1020:1055;iy=475:480;bf{5}(ix,iy)=0;
ix=1020:1055;iy=481;bf{5}(ix,iy)=(bf{5}(ix,iy-1)+bf{5}(ix,iy+1))./2;
ix=1080:1140;iy=530:540;bf{5}(ix,iy)=0;
ix=1080:1140;iy=541;bf{5}(ix,iy)=(bf{5}(ix,iy-1)+bf{5}(ix,iy+1))./2;
ix=1140:1151;iy=540:626;bf{5}(ix,iy)=0;
ix=1139;iy=540:626;bf{5}(ix,iy)=(bf{5}(ix-1,iy)+bf{5}(ix+1,iy))./2;
ix=1140:1147;iy=807:810;bf{5}(ix,iy)=0;
ix=1140:1147;iy=811;bf{5}(ix,iy)=(bf{5}(ix,iy-1)+bf{5}(ix,iy+1))./2;
ix=1139;iy=807:811;bf{5}(ix,iy)=(bf{5}(ix-1,iy)+bf{5}(ix+1,iy))./2;
ix=852:855;iy=411:420;bf{5}(ix,iy)=0;
ix=856;iy=411:420;bf{5}(ix,iy)=(bf{5}(ix-1,iy)+bf{5}(ix+1,iy))./2;
ix=1125:1130;iy=743:766;bf{5}(ix,iy)=0;
ix=1124;iy=743:766;bf{5}(ix,iy)=(bf{5}(ix-1,iy)+bf{5}(ix+1,iy))./2;

%South America
ix=1170:1172;iy=838:840;bf{5}(ix,iy)=0;

ix=1260:1267;iy=952:960;bf{5}(ix,iy)=0;
ix=1260:1267;iy=961;bf{5}(ix,iy)=(bf{5}(ix,iy-1)+bf{5}(ix,iy+1))./2;
ix=1259;iy=952:961;bf{5}(ix,iy)=(bf{5}(ix-1,iy)+bf{5}(ix+1,iy))./2;

tmp=cat(1,sym_g_mod(bf{3},7,0),bf{5});
figure(6);clf;colormap(jet(21));mypcolor(-359:1440,1:1080,tmp(1080-360+1:end,:)');
caxis([0 20]);colorbar;grid;set(gca,'Xtick',-nx:60:nfx(5),'Ytick',0:60:nfy(5));

%put back into compact format
bc=-abs(cat(2,bf{1},bf{3},reshape(bf{4},1080,540),reshape(bf{5},1080,1440)));

fOut=[dirBathy 'bathy_aste1080x1440x540_v2.bin'];
writebin(fOut,bc,1,'real*4');fprintf('%s\n',fOut);
